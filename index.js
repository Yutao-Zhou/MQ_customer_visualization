const customers = "中央广播电视总台 中央人民广播电台 福建省广播影视集团 福建省广播电视传输发射中心 北京电视台 北京歌华有线电视网络公司 天津电视台 河北省电视台 辽宁电视台 吉林省电视台 黑龙江电视台 内蒙古电视台 宁夏电视台 山西电视台 河南省电视台 山东电视台 甘肃省电视台 新疆电视台 西藏电视台 江苏省电视台 安徽省电视台 江西省电视台 湖南电视台 贵州省电视台 云南省电视台 广西省电视台 广东电视台 海南省电视台 辽宁省传输发射中心 山东人民广播电台 湖南省教育电视台湖南省广播电视微波总站 山东省教育电视台江西省教育电视台 江西省广播电视网络传输有限公司及下属多个分公司 甘肃省广播电视网络传输有限公司及下属多个分公司宁夏广播电视传输发射中心 河南省人民广播电台 深圳市电视台 厦门市电视台 石家庄电视台 邢台电视台邯郸电视台 秦皇岛电视台 衡水电视台 唐山电视台 唐山市广电网络公司 承德广电网络公司 东港电视台 营口电视台 大连电视台 丹东电视台 鞍山市人民广播电台 东港有线台 铁岭市电视台 辽阳市电视台 双辽市电视台 吉林市电视台 通化广电网络公司 大庆电视台 黑河电视台 鹤岗电视台 七台河市电视台 双鸭山市广电网络公司 鸡西电视台 盘锦电视台 呼和浩特电视台 包头电视台 乌海电视台 赤峰电视台 锡林浩特电视台 鄂尔多斯电视台 乌兰察布电视台 呼伦贝电视台 通辽电视台 太原电视台 晋城电视台 运城电视台 大同电视台 榆林电视台 吕梁电视台 钦州电视台 临汾电视台 朔州电视台 神木电视台 阳泉电视台 长治电视台 济南电视台 烟台电视台 威海电视台 东营电视台 滨州电视台 德州电视台 日照电视台 潍坊电视台 菏泽电视台 临沂电视台 乳山电视台 泰安电视台 济宁电视台 聊城电视台 周口电视台 安阳电视台 洛阳电视台 信阳电视台 南阳电视台 新乡电视台 濮阳电视台 焦作电视台 商丘电视台 驻马店电视台 平顶电视台 许昌电视台 漯河电视台 三门峡电视台 西安市电视台 宝鸡电视台渭南电视台 延安电视台 榆林电视台 汉中电视台 渭南电视台 咸阳电视台 汉中电视台 安康电视台 铜川电视台 石嘴山电视台 固原电视台 吴忠电视台 中卫电视台 酒泉卫星发射基地电视台 酒泉广电网络公司 敦煌广电网络公司 张掖电视台 武威电视台 临夏广电局 定西电视台 白银电视台 天水电视台 西宁电视台 海西州电视台 湟中广电局 乌鲁木齐市电视台 克拉玛依电视台 霍尔果斯电视台 和田电视台 农五师电视台 阿拉泰电视台 伽师广电局 阿瓦提 广电局塔什库尔干广电局 英吉沙广电局 柯坪广电局 拉萨市电视台 那曲电视台 昌都五县电视台 日喀则电视台 雅安电视台 南充电视台 遂宁电视 青川广电局 汶川广电局 广汉电视台 什邡广电局 三台电视台 江安广电局 巴州电视台 昆明市电视台 曲靖电视台 大理电视台昭通电视台 贵阳市电视台 遵义电视台 毕节电视台 安顺电视台 同仁电视台 南宁市电视台 百色电视台 贺州电视台 钦州电视台 柳州电视台 梧州电视台 河池电视台 玉林电视台 贵港电视台 崇左电视台 广州市电视台 揭阳电视台 梅州电视台 汕尾电视台 阳江电视台 韶关电视台 湛江电视台 江门电视台 云浮电视台 常德电视台 益阳电视台 邵阳电视台 浏阳电视台 怀化电视台 娄底电视台 株州电视台 鄂州电视台 荆门电视台 咸宁电视台 十堰电视台 黄冈电视台 黄石电视台 荆州电视台 潜江电视台 九江电视台 赣州电视台 宜春电视台 新余电视台 抚州电视台 鄱阳广播电视局 安庆电视台 芜湖电视台 阜阳电视台 铜陵电视台 蚌埠电视台 宿州电视台 滁州电视台 刘安电视台 南京市电视台 宿迁电视台 连云港电视台 盐城电视台 常熟电视台 南通电视台 常州电视台 台州电视台 丽水电视台 衢州州电视台 瑞安电视台 富阳电视台 温州电视台 福州市电视台 漳州电视台 宁德电视台 龙岩电视台 南平电视台 安溪电视台 泉州电视台   海口电视台 三亚电视台 张家口下花园广电局 河北迁安广电局 河北迁西广电局 河北正定广电局 北京市丰台区广电网络 贵州遵义电视台 北京市大兴区广电网络 海口市广播电视局 北京市通州区广电网络 江西省永新广电网络 北京市房山区广电网络 山西代县广播电视局 山西左云广播电视局 北京顺义广播电视局 河北省丰润广电网络 大连广播局大和尚山微波站 河北省滦平广电局 河北省丰宁广电局 河北省迁西广电局 江西省宜春广电网络 江西省乐平广电网络 江西大余广播电视局 江西省兴国广电网络 山西天镇广电局 内蒙赤峰平庄矿务局电视台 四川省万县电视 四川省江油电视台 山东莱阳电视台 山西灵丘广电局 甘肃武都广电网络 甘肃西峰庆阳广电网络 江西省乐安广电网络 辽宁建平广播电视局 陕西高陵广播电视局 河南永煤集团电视台 江西省南丰广电网络 江西省东乡广电网络 河北磁县有线电视台 湖南麻阳广播电视局 江西兴国广播电视局 中央军委八一大楼 中国人民解放军国防大学 中国人民解放军海军大院 中国人民解放军空军大院 中国人民解放军空军指挥学院 中共中央统战部 中国人民解放军后勤指挥学院 中共中央宣传部 中国人民解放军总装备部 北京市检察院二福建省委组织部 中国人民解放军装甲兵工程学院 中国人民解放军总参谋部 中国人民解放军中部战区 中国人民解放军防化学院 中国人民解放军交通指挥学院 中国人民解放军武警指挥学院 中国人民解放军军事医学院 中国人民解放军总医院 北京市通州区人民政府 中国人民解放军海军总医院 中国人民解放军空军总医院 中国人民解放军302医院 北京市工商管理局丰台分局 中国人民解放军304医院 北京市工商管理局通州分局 中国人民解放军306医院 北京大学 清华大学 中国传媒大学 华东师范大学 首都师范大学 中国农业大学 中央民族大学 北京人民警察学院 武警音像出版社 中国人民解放军总参办公厅 国家海洋环境预报中心 信息产业部第二研究所 中国人民政协礼堂 北京卫戍区通信某部 中国社会科学研究院 北京市建筑设计院 中国海军设计院 北京八一电影制片厂 北京市广安门中医院 天津交通指挥学院 河北邢台市 66220部队 宁夏回族自治区人民政府 北京市海淀信息中心 山东莱阳农学院 北京科技大学自动化研究所 北京市质检局 中国人民解放军总装备部挥学院 中共中央组织部 中国人民解放军总后油料所 北京市东城城管 北京海淀教育中心 北京市铁路公安局 北京市质检局 国家教委 国家体育总局 北京顺义地税局 海军干休所 国家安全局 北京市安全局 银川市政府 中国人民解放军二炮指挥学院 泉州洛江区委宣传部 全军计划生育培训中心 解放军卫生音像出版社 北京市房山区计划生育委员会 河南省焦南监狱 北京西城城管大队 福建公安边防总队 北京武警十四支队 北京市房山区地税局 福建晋江交警大队 北京军区某高炮旅 北京市公安局故宫派出所 甘肃河西学院 中国农业大学 贵州大学职业技术学院 潍坊学院文学与新闻传播学院北京电气工程学校 中共盐城市委组织部 广东省公安厅 空军情报部 河南省商丘市商丘师范学院 河南理工大学 北京市广安门中医院 北京市宣武医院 贵州省人大 河南中州大学 北京商务科技学校 黑龙江省气象局 广东省气象局 广西自治区气象局 海南省气象局 河北省气象局 湖南省气象局 辽宁省气象局 厦门市气象局 西藏自治区气象局 云南省气象局 湖北省气象局 吉林省气象局 江西省气象局 宁夏自治区气象局 青海省气象局 山东省气象局 河南省气象局 陕西省气象局 甘肃省气象局 天津市气象局 重庆市气象局 浙江省气象局 内蒙古气象局郑州市气象局 广西梧州市气象局 兰州大学 国家电网 中国移动 北京地铁 字节跳动 中国航天集团 中国联通 中国电信 京东方电子 三星电子 新华社 北京铁路局 平安保险 北大方正集团 清华泰豪集团 中国通广集团 ABB电子集团 茅台集团 中国运载火箭研究中心 成都索贝数码科技股份有限公司 四川电视台索尼维修站 中船重工七一二研究所 中船重工七一七研究所 福建省电力试验研究院 天安门管理委员会 北京市颐和园 北京市故宫博物院 北京天坛公园 北京市香山公园 北京花乡花木集团 北京市动物园 北京吉林大厦 北京市画院 北京市铁路局 北京市首都机场 北京市保利剧院 北京市燕山石化总公司 北京市首都图书馆 清华紫光软件有限公司 中国航天工业总公司 三峡库区地质灾害防治中心 中国电信北京分公司 中国通广电子集团 北京苏源锦江大厦 北京新奥特集团 北京星城国际大厦 松下系统集成公司 联合国竹腾培训中心 北京中科大洋科技有限公司 京东方电子集团 ABB电子集团公司 信息产业部第二研究所 北京时代奥视公司 中国光大银行长春分行 中国航天工业总公司 上海JVC系统工程公司 安徽励图公司 中国机械科学研究 北京格非视频技术有限公司 北京安达斯系统集成有限公司 沈阳电视台索尼维修站 北京市建筑设计院 北京云创公司 汤姆逊公司北京办事处 北京市丰台体育中心 北京捷成世纪公司 北京中化大厦 内蒙古包头钢铁厂 北京正奇公司 四川攀枝花钢铁厂 湖北武汉钢铁厂 北京世达时代集团 山东青岛中银大厦 北京德文兴业公司 北京中钢实业总公 河南中视公司 冶金自动化院 北京首都钢铁厂 北京明城墙遗址公园 北京健侬电视技术公司 西安赛能公司 国华定州发电公司 内蒙古通辽飞机场 山西大同铁路分局 北京远洋风景小区北京外交人员服务中心 北京华易众欣公司 北京先农坛体育中心 人民日报社 首都图书馆 华普产业集团 晋城矿物局 北京天地通技术有限公司 华北石油管理局 北京望京小区 武汉铁路局 北京永兴众智公司 北京高教出版社 北京世侨国贸大厦 北京英夫美迪公司 辽宁大连天津街 北京广播电影电视设备制造厂北京中联汽车交易市场 北京冠华荣信公司 北京中山消防保安技术有限公司 湖南双菱公司 秦皇岛港务局 甘肃兰州交通银行 北京城建档案馆 北京中星兴悦公司 北京京铁家园 廊坊石油大厦 北京高碑店污水处理厂 三星电子集团 新疆博物馆 中国平安保险大厦 北京大帅公司 北京欢乐谷 广州振视公司 福建体彩中心 深圳佳创视讯技术有限公司 成都德特公司 北京永新同方数字技术有限公司 北京龙潭湖公园 河南安阳安贞集团北京中广上洋公司 河北承德劲复康制药集团 中国运载火箭研究中心 北京燕山石化总公司 北京世界花卉大观园 北京中视融创公司 辽宁大连王进喜纪念馆 北京好易购家庭购物公司 濮阳中原油田 晋城煤业集团新闻中心 武汉捷视公司 安徽省地震局 昌乐传媒集团 邯郸千叶草公司 外联三室 燕山石化传媒中心 中国石油天然气管道局 甘肃联合大学国资处 北京宇田冠泰公司 大连市档案局 周口人防办 伊宁市文化体育广播影视局 北京星光集团 山东聊城体网 中国联通公司 深圳亚太卫视文化传播有限公司 东营区委组织部 新疆农十师新闻中心菏泽市人口和计划生育委员会 包头市广播电视报传媒有限公司 希望在线公司技术部 大庆新闻传媒集团 北方联合媒资运营平台 中国棋院 广西图书馆 中国体育彩票中心 潇湘电影制片厂 中国石油管道管理局 北京市消防局 湖南华菱涟源钢铁集团"
const locationNames = customers.split(" ");
const apiKey = 'API_KEY';
// Define an array of location names to geocode
let broadcastingStations = []; 

let promises = locationNames.map(function() {
  return fetch('customers.json')
  .then(response => response.json())
  .then(data => {
    // You can now access the JSON data and save it as a letiable or perform further processing
    broadcastingStations = data;
    // Use jsonData letiable for further processing or saving as needed
  })
  .catch(error => console.error('Error fetching JSON:', error));
});

Promise.all(promises)
  .then(() => {
    // Create a Leaflet map centered at a specific location
    let map = L.map('map').setView([35, 105], 5);

    // Add a tile layer to the map for displaying the map tiles
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', {
      attribution: 'Map data &copy; CartoDB'
    }).addTo(map);
    const leafletIcon = L.icon ({
      iconUrl: "./MQ.jpg",
      iconSize: [30, 30],
      iconAnchor: [15, 15]
    })

    // Loop through the broadcasting stations and add markers to the map
    for (let i = 0; i < broadcastingStations.length; i++) {
      let station = broadcastingStations[i];
      if (station !== undefined) {
        let marker = L.marker([station.lat, station.lon], {icon: leafletIcon}).addTo(map)
        .bindPopup('<b>' + station.name + '</b><br>Lat: ' + station.lat + '<br>Lon: ' + station.lon);
      }
    }
  });

// // Create an array of promises for each fetch request
// let promises = locationNames.map(function(locationName, index) {
//   return fetch(`https://maps.googleapis.com/maps/api/geocode/json?region=CN&language=zh-CN&address=${locationName}&key=${apiKey}`)
//     .then(response => response.json())
//     .then(data => {
//       if (data.results.length > 0) {
//         // Extract the latitude and longitude coordinates from the API response
//         let latitude = data.results[0].geometry.location.lat;
//         let longitude = data.results[0].geometry.location.lng;

//         // Use the obtained coordinates in your application as needed
//         broadcastingStations[index] = {
//           name: locationNames[index],
//           lat: latitude,
//           lon: longitude
//         };
//       } else {
//         console.error('Failed to geocode location:', locationName);
//       }
//     })
//     .catch(error => console.error('Error geocoding location:', error));
// });

// // Wait for all promises to resolve
// Promise.all(promises)
//   .then(() => {
//     console.log(broadcastingStations);

//     // Create a Leaflet map centered at a specific location
//     let map = L.map('map').setView([39.905131, 116.461176], 12);

//     // Add a tile layer to the map for displaying the map tiles
//     L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
//       attribution: '© OpenStreetMap contributors'
//     }).addTo(map);
//     let s = 0;

//     // Loop through the broadcasting stations and add markers to the map
//     for (let i = 0; i < broadcastingStations.length; i++) {
//       let station = broadcastingStations[i];
//       if (station !== undefined) {
//         s++;
//         console.log(s)
//         let marker = L.marker([station.lat, station.lon]).addTo(map)
//         .bindPopup('<b>' + station.name + '</b><br>Lat: ' + station.lat + '<br>Lon: ' + station.lon);
//       }
//     }
//     function download(content, fileName, contentType) {
//       let a = document.createElement("a");
//       let file = new Blob([content], {type: contentType});
//       a.href = URL.createObjectURL(file);
//       a.download = fileName;
//       a.click();
//     }
//     download(JSON.stringify(broadcastingStations), 'customers.json', 'text/plain');
//   });